== Introduction ==

This page is DRAFT!!


The Contest Data Server (or CDS) is a single place for clients of any kind to request contest data via URL. This document contains information on what services (URLs) are available from the CDS, what content is returned, and links to specs for the format of some files.

Internally, the CDS may be implemented using multiple servers, pull data from the contest control system or other servers, or even aggregate. From a client perspective the important thing is that ''none of this matters'': the CDS is a one-stop shop for all contest information. Clients only need to know how to connect to URLs.

It's best to think of the CDS as an aggregator and gate keeper. There will be extensions that plug onto the CDS and provide new content or convert formats, but these are more like applications hosted by/within the CDS.

=== Why do we need a CDS? ===

We've run many finals without a CDS, so why do we need one now? Using a CDS has several advantages:

* '''Standard-based''': Regular HTTP access to everything.
* '''Consistency''': Similar URLs and formats where it makes sense.
* '''Simplicity''': A one stop shop for clients. A single URL and access request for multiple services.
* '''Data''': Access to new data like team logos & pictures, contest images, etc.
* '''Security''': HTTPS and single point of control.
* '''Caching''': Reduced load on contest control system.
* '''Robustness''': Clients no longer connect directly to critical contest systems.

There are also some benefits we can take advantage of in the future:
* '''Scale''': Architecture allows us to use an HTTP server and scale out to handle load.
* '''Robustness''': Fail-over with multiple CDS servers. Handle DOS attacks.

=== Implementation Notes ===

* URLs below are in the format "http://cds/xyz". The exact hostname or IP address for 'cds' each year will be provided once the network is setup onsite.
* Some of the URL contain a year (e.g. http://cds/2014/xyz") to indicate that these are temporary formats that will almost definitely change over the following year.
* Invalid URLs, parameters (e.g. teamNum=500), or missing images will return the standard HTTP status code 404.

== Access & Authentication ==

Requests for access to the CDS must be made through the world finals technical director (John Clevenger) and must include contact information for during the finals. Many of the services will contain private information, so each client will be given a unique user id & password to connect to the CDS. Access to all secure services is via HTTPS. (HTTP access will be redirected)

To simplify security, access is provided via roles that each have access to different content. The defined roles are as follows:

* Internal = Internal users (typically on the contest network) that have access to all content.
* Trusted = Clients that have access to some contest information that should not be shared publically.
* Public = All other users that have access only to public information.

Services will be marked with what access role is required.

== Services ==

The following section describes all of the services that are available through the CDS.

=== Contest Configuration ===

 <nowiki>URL: http://cds/config/contest.yaml
URL: http://cds/config/problemset.yaml
URL: http://cds/config/groups.tsv
URL: http://cds/config/teams.tsv</nowiki>

Access to contest configuration files as specified in the CCS spec [[Contest Control System]].

=== Team University Logos ===

 <nowiki>URL: http://cds/images/logo/[teamNum]</nowiki>

Returns a png image 600x600 or smaller of the given team's University logo.

=== Team Images ===

 <nowiki>URL: http://cds/images/team/[teamNum]</nowiki>

Returns a full HD jpeg image (1920x1080) of the given team, typically taken during registration.

=== Contest Control System Event Feed ===

 <nowiki>URL: http://cds/2014/events</nowiki>

Returns the 2014 event feed as generated by the CCS: [[Event Feed 2014]].

=== Contest Control System Event Feed Proposal ===

 <nowiki>URL: http://cds/proposed/events</nowiki>

Returns a modified event feed that will match the proposed future standard. TBD

=== Contest Control System JSON Scoreboard ===

 <nowiki>URL: http://cds/2014/standings</nowiki>

Returns a JSON scoreboard as defined here: [[JSON Scoreboard 2014]]

=== Team Webcam Stream ===

 <nowiki>URL: http://cds/video/camera/[teamNum]</nowiki>

Returns a video stream from the camera at the given team's workstation.

* Video container: FLV
* Video format: H.264

=== Team Desktop Stream ===

 <nowiki>URL: http://cds/video/screen/[teamNum]</nowiki>

Returns a video stream of the given team's desktop.

* Video container: FLV
* Video format: H.264

=== ICPC Graphics  ===

Returns one of several ICPC graphics images for use by TV Production

=== Run submission source ===

 <nowiki>URL: http://cds/runsource/[runId]</nowiki>
